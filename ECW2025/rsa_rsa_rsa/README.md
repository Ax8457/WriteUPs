# Crypto - RSA RSA RSA

<p align="justify"> In this challenge the goal was to retreive the plaintext of the ciphertext encrypted using RSA cryptosystem. To do so, a signle png was provided as well as information about cryptosystem used: the modulus n is actually a prime number.</p>

<p align="justify">The first step is to extract hidden informations in the png. A quick hexdump reveal that all is hidden at the end of the png after end of file. 20 primes number are finally extracted as well as ciphertext int value: </p>
  
````python
#hexdump -C esna_FileEncryption.png | tail -n 500
#hexdump -C esna_FileEncryption.png | grep -C 15 "p="
#hexdump -C esna_FileEncryption.png | grep -C 15 "C="
p1=20450324901386118491163145816030798935926625968872145846000104558526211035268460999152822383451140011646061021095733134747455290317259424230191863070658343383530631469400312490288280057953282409914598388651295480338352724950751232742033760881033490392742941533711839288496432913804395250360291369529342888655692892487828730826801603416887379880789156939624231953182793547628971607096017114525675771421102970735190837286958548763361119835286108174587490047362633540962284782498181603118598825098078082062511078907985399175750333301751959231624898617954167815658732088985157199810673501975598210578872449606816664738147
p2=26490621378058935841397334287712110279594669955443763673694172830156683128155947056175271570429935787278784503108502097302213413527259646694751671973536244056983308857329741114624314486741538176698484539302879810991661344367743099131705837082400873393578401331841365831844229343232839232032178202618430454816899824690353270852934020105689907052321649906866681390441727783213307753459032449507277284012464047239714346705616880236761516125788943536176072063890883009500321308838398064647025016876262609586872806468086336498502082503229394285850642511277059896338219315197115487145611585556823108472102423337955098478419
p3=22124393027820898294183017737809876759557324643293730356410048408116459350700344516564291175747255114241074087638030871347502724286661009256419114346696043403880354366320064595337688870848908725318092222561237917082055117744550208210789543750984828184426547167549337417805635255567152885089565605498327842382107824579574740186296408199550209012573501262494167894917979510631646285091204775386816522413626914153421949341371792814702017279253803313382003198642860169317136114186489251503219978982040533062651841866657421460205301873987182016222093252656747184665468494433715577649783586243139175263141212129271324268427
p4=23235381065049084665365960641728282697748744379219463578389767764515572633966935575872442806254250879554538854118192490361833185017941260048597787741613317610825564387995056477435630362417503765836756397682681080118654105745623995374527956060976875748256194538248753742273115309024794735129311079214296791026624338204149556247542933256035567949179722591472823591410166492546877231111719020533391704471540000811337017576323446622040015178060878072546285203507372519369860938587208725422640780566581883496722904538736526884185606451156950201243490076983613356583111693742410312618545917682689326331904265711093832526573
p5=21016317476800444857980994691994075554108101058989411874710643866485458944113010059277610620141047992859404032847940813580196720569533490974094003520648109537036332292106439337887454811490970781780669461542209429971540899487282361845604849572580927267907538748883386742014870245443254414558106448261785463462031491693544628325169413443756303591272156965918056637958469008884692881008780888384018112198327452739714586102130947309990619604430730279070406696514421096046657099330895889363220487810266348917282282714343407359919388347859022891399921090792584550631551594765747192140298283190208387904840688489137713765191
p6=31411710201481494710646222346520976376943926320736142944803732806507569821893994110566491137913478000650818858377601618133154317690367615639050001853443073884230641625860416735595725848962278951696364445749479000329088499249135060754081096181319049459280747056523513516189562306609203097570705300680348951047914651371692856804162153485736645073335318582778672792298888678461053943751314814115565547855595906827911042292758597620222364091596054554492459283914610601262979178833430110944402361852631804753390814159806712676443075977055694266052070307237890340023172870459143141473759547527609677782110310584452976860673
p7=28660083619260761889845464040187150339435288420560982589146244000801497088086856104968311046696193326997386629425553898295124975432001383401850709340300123847257041219513379289783949302694838832708775129422575143057975293307055082219621972880011674819378460293795943639216795787930060048945511122703296151661449647573424544224821628901187737991410899155820278334994527032732380991625753256572909431275940344943274719414583389055794313470804631951684203400833219511686393847163068448640239130610974036481777960444556099010542812931954273089257663993664809636473883880458579737758097323456494515802309733083469299697383
p8=18758271282542695726601793957413626462984307489222639431825367688814948136330936900384196966684384438755951987493398633989884780373125255114467493760217576876948029843850772896795884298431751931927677162688933997008968462909404467267377470056095777644515585820019624895755853553224111047722124114017745086543937382544686670435965188885501538213871980009604499625808041023848323470621571009434878911324984269453293813643218042985408966073611640619607335971711013552965695903166316410405602932088563930979197003483818311634064132695742740998552100561885581951370395217822644873664190107766564730327243267561357290627403
p9=17991033921834667769791346673126917854973508990757865275591333708626778214007592347759277677963997296435426858263184750873523381001438984364675679169440818738111397275861610632775385632294833908894416514892038119726180274788099736515062150526260902312947785598251301927526051381500497440901064476570516554079052842683162475519401799355526278467512755552475671630934597658124305132644857355819838995673704502842110279062625880165533284354222644601656084020951662164917336217221137768104657000606998180148116136530532402543912546034600522706042485259388940043960834931912833647981895281326399329959341644877510025985259
p10=24312537759276391387522343533762166104534204580635606299984999678425947565835458010017082355326903956735399971683620023889892759093218117198166565176205056638183701366678642595463515764399477855518406098518593818637963168266944067706489061873791116251327405403949457815339234621979535671531218354489136914077788913803360950673495997210497498209107712474963393244781194419003946057541872707575132817004981003252659620735278424042675308510984390660082786317984577247676078988912604702574128030271640763474620308328150699770070547112546465403113051709675460411520276616049827614658415334220189602462577453950106662005733
p11=21931338231515426150936286936129207074716384407639040554506262214591209644699280145896656004740381559370178972818857674438152191948193061628586025030515883568066695479222350177389812551303385851367114534544172424676885236896483356794417669749499006828316831106879278763916974777419402174329102029155746946153272462573454152859750397806098694472650965141036798938645216516372374894567896684965901085849024914192627368616324132019337815446284230604653860443107943478774405005572409633779209351139052850324927812859616088571872462502825324686051688321219976601368492034216644537597251381581892972691708593450917065552729
p12=26079709062568158657691342444060724476805443251969170437030628087061700908042800144296517477642703618523898834954222176416617981274196650474738361404214342677638617529095523376803133065674236755941379095366248109697053123350499148907877223046750344427335252283714020782535257648545468031604324710036417602090394816954484374721822005861014041394177651189870486149977753742700583384858361758911788733255744996955140873338371550376287135556382818468032019281561755239799750817824738741054241653504230472716487730776046052054157072208992221753515752400792703731454051312853344500699983625356418888438915193153136262431933
p13=19453154433986500039395692956917686302349305912926960510661467576173050086544337701369948228555522629143605495040386086263352467904297721551613948486634088668176327445855425946406941072356054923904731410428354321834827484996242505766466489063978267077751822854511802378950982274104075364816733682631858671148983745179318675346752009069164275748654096544260382721877786853763070283760254439896681507750948396796270723880654883133717479091274896217184235037346186969719933598586901333371809573686614865613454343438674688975788554862696889428476388375429457768024961532470183925344198002415616029614312978280014643669319
p14=17280200487302590290737238059991657126886703376183616933598838102769099126595650204762456383528762432689834757023871016344565695454918565471257928267237300814143909887122492508380033914800108297579270983460427754369353776757810819135693314610270664260062737422009284525321839481556297336481831411840613294798771509452682735246427010584818086284687712560445022606668765747508241948262877213061217153065257457620877036659981540742550460326642238624786456749039727408435526266520494892750826884397301543531451489578089892599768204931152396101502634413062222528744985165110136195739234849684449821342515267544604062222633
p15=20468908554096781345524233524029429128701341019643488381348695608470265978686358308959850420668543469993398300689443855767363471387733164901506621219295078260160443465812249298104384941082651050386796949981957616364653964106923780178628950286233492551170332506890904484702104082262991797277664578121259241835470654996164330096746485838313597851682049897900260517013461958589169347760095965209860452463333152350596921598352082459978608435658878641413488428616406439995159556811311192223751956222652041871069771661631268050552493901418148687839815141730547409854710499088866177572699401131437119428911300989872422783351
p16=21984507434645758489889665864488002673399797689275822086541766785826176369920223893932892991017456979133689528634743287863336951290286439628667084220317579866633836973367870696369427369728535049166982654822671698165652137808949181152297389824120078479723631167020872736321996166790821673352636968419063852274674129385033087890647584967724124051791531736609867219166785062196329739614415820419014187423918540602985309026905100834597432488610995111446138217184627434781029838080107991454815949299786217761467810392225746250668373724655278897329113571268527927279902952156676397131246324760162863915539282286826256411381
p17=26330988573262539666499898109444025729433958923481997482896435915554037991284743337805245539099310925897449920424841379698475369575333160838168774095349642078014592136876642207338959986008291909047756403386072518205803226736845175339708331469989914822939140072933202282482865506947032247488569670011631009009522378053116881835330168683562279051266149062116276817962945737821013870065925965760649346887874816605410390847107906806001340298062322612646609975972049955857562506474357895105210973244325829295638371277930607033549901721407571328561788847600318516288355078572102019920387807979880563531038818866427987555157
p18=25852531296071472153024812945091028446866971926074717718287059550003976945933511156762384618996835783059015260200733628124283205509107443364933792205014881101075928690500570040745476609690935292599586415958666480278960502995690575990273723370360369671003207319494504810576313346990023788150269525006125391159663239226339903348017666664195877669679819549183822953238912224122141152519736420900790031247228239895294042197369819973276540883981697712824711525776057293946588766505319548124683251631830790140986564266485827366838555690849032835534858881028093341801221844935979334375774559100822641423107117981012749277651
p19=19558468329039583354605220761940488156736253044820278342990728908279922122437365885285569443309617547584550129950558689314072588546768755799913763980919198625814565678364751345021570694533736306317448698005023434649620999937315193212254182794658996176205115074290121183661502060277746376439248770254131597709947695635740251594119034325528935594914322414394470454010609694437317379107550254839711323959551243333984960437137416812074018125834900084197244547255208361240352825391577430176713768025713326759067760850756755312755144655584660891554672538659677263334430871802364773746967760709279615388810438144514274329741
p20=25145444760790060832535495573467736498205562088251191321200720445688458688144144607255946904003393919472091422103839002298965598395394847653786733599499722414487311501122769569786635605856334924248141373753688824443703732365821936028930808155131742975736076537208772531487849268765902184416576556480744084321840003734190271371166158759351132818772158143534158342952584327157334756538758968164100096779203301312714175515793781544045203634444807834123195794989649076724465100659944977637642328824467310805994828538621125840029990463032287057474888897266412669721629780844948328576479553771221039627902837462820190070809
````

### RSA cryptosystem when N is Prime
<p align="justify">Now let's dive into RSA cryptosystem. Below is the Euler totient function with respect to Euler's theorem, on which RSA cryptosystem lies.</p>

<p align="justify"> The prime factorization is given below (each p is prime, alpha is the power of each prime): </p>

$$
n = \prod_{i=1}^k p_i^{a_i}
$$

<p align="justify">Then the Euler Totient function can be computed using:</p>

$$
\phi(n) = n \prod_{i=1}^k \left(1 - \frac{1}{p_i}\right)
$$  

<p align="justify">And below is the relation below public key and private key:</p>

$$
ed \equiv 1 \pmod{\varphi(n)}
$$

<p align="justify">But what if n is prime ? Then: </p>

$$
n = p
$$

<p align="justify">And Euler Totient function simplifies to: </p>

$$
\phi(n) = n - 1
$$  


### Solv
<p align="justify">Actually given the primes retreived, the logic is exactly the same as <a href="../RSAd/">RSAd</a> challenge but here no factorization is needed because primes facors are known, and as a matter of fact, no information about public key (e,n) was provided but it's assumed that e is 65537. Because prime facors are known it's possible to compute Euler totient and retreive private key. The script solv1.py implements the solv. After running it, the following output is printed :</p>

````bash
b'C = 321820092380837650075502901554553740917669882504596498051700306408353335244201235073143359660273192195417546254118040290779156171623509695296575140144324327019048267114829 N = 388891390351190339486808537827923007434166077468787484562874545771559109089260400240540111721655076663134759163570606594727034649705238717956095821149283571571129301125071'
````

<p align="justify">This is a second RSA challenge which follows exactly the same logic. The script solv2.py implements the solv, but instead of using factors to compute totient, it leverages the Euler totient simplification (because n is  prime) and simply substracts 1 to N to get the totient.</p>

FLAG: _ECW{c3ab8ff13720e8ad9047dd39466b3c8974e592c2fa383d4a3960714caef0c4f2}_ , thanks _Rufus_ for this challenge !
